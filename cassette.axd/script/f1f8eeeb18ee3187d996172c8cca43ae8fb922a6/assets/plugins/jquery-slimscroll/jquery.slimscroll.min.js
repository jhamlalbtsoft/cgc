/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.0.6
 *
 */
(function(n){jQuery.fn.extend({slimScroll:function(t){var i=n.extend({wheelStep:20,width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,scroll:0,touchScrollStep:200},t);return this.each(function(){function e(n,t,e){var o=n,h=r.outerHeight()-u.outerHeight();t&&(o=parseInt(u.css("top"))+n*parseInt(i.wheelStep)/100*u.outerHeight(),o=Math.min(Math.max(o,0),h),u.css({top:o+"px"})),f=parseInt(u.css("top"))/(r.outerHeight()-u.outerHeight()),o=f*(r[0].scrollHeight-r.outerHeight()),e&&(o=n,n=o/r[0].scrollHeight*r.outerHeight(),n=Math.min(Math.max(n,0),h),u.css({top:n+"px"})),r.scrollTop(o),y(),s()}function v(){b=Math.max(r.outerHeight()/r[0].scrollHeight*r.outerHeight(),tt),u.css({height:b+"px"})}function y(){v(),clearTimeout(k),f==~~f&&(l=i.allowPageScroll,g!=f&&r.trigger("slimscroll",0==~~f?"top":"bottom")),g=f,b>=r.outerHeight()?l=!0:(u.stop(!0,!0).fadeIn("fast"),i.railVisible&&o.stop(!0,!0).fadeIn("fast"))}function s(){i.alwaysVisible||(k=setTimeout(function(){i.disableFadeOut&&c||p||w||(u.fadeOut("slow"),o.fadeOut("slow"))},1e3))}var c,p,w,k,d,b,f,g,tt=30,l=!1,r=n(this),a;if(r.parent().hasClass("slimScrollDiv")){var h=r.scrollTop(),u=r.parent().find(".slimScrollBar"),o=r.parent().find(".slimScrollRail");v(),t&&("scrollTo"in t?h=parseInt(i.scrollTo):"scrollBy"in t&&(h+=parseInt(i.scrollBy)),e(h,!1,!0))}else{i.height="auto"==i.height?r.parent().innerHeight():i.height,h=n("<div><\/div>").addClass(i.wrapperClass).css({position:"relative",overflow:"hidden",width:i.width,height:i.height}),r.css({overflow:"hidden",width:i.width,height:i.height});var o=n("<div><\/div>").addClass(i.railClass).css({width:i.size,height:"100%",position:"absolute",top:0,display:i.alwaysVisible&&i.railVisible?"block":"none","border-radius":i.size,background:i.railColor,opacity:i.railOpacity,zIndex:90}),u=n("<div><\/div>").addClass(i.barClass).css({background:i.color,width:i.size,position:"absolute",top:0,opacity:i.opacity,display:i.alwaysVisible?"block":"none","border-radius":i.size,BorderRadius:i.size,MozBorderRadius:i.size,WebkitBorderRadius:i.size,zIndex:99}),nt="right"==i.position?{right:i.distance}:{left:i.distance};o.css(nt),u.css(nt),r.wrap(h),r.parent().append(u),r.parent().append(o),u.draggable({axis:"y",containment:"parent",start:function(){w=!0},stop:function(){w=!1,s()},drag:function(){e(0,n(this).position().top,!1)}}),o.hover(function(){y()},function(){s()}),u.hover(function(){p=!0},function(){p=!1}),r.hover(function(){c=!0,y(),s()},function(){c=!1,s()}),r.bind("touchstart",function(n){n.originalEvent.touches.length&&(d=n.originalEvent.touches[0].pageY)}),r.bind("touchmove",function(n){n.originalEvent.preventDefault(),n.originalEvent.touches.length&&e((d-n.originalEvent.touches[0].pageY)/i.touchScrollStep,!0)}),a=function(n){if(c){n=n||window.event;var t=0;n.wheelDelta&&(t=-n.wheelDelta/120),n.detail&&(t=n.detail/3),e(t,!0),n.preventDefault&&!l&&n.preventDefault(),l||(n.returnValue=!1)}},function(){window.addEventListener?(this.addEventListener("DOMMouseScroll",a,!1),this.addEventListener("mousewheel",a,!1)):document.attachEvent("onmousewheel",a)}(),v(),"bottom"==i.start?(u.css({top:r.outerHeight()-u.outerHeight()}),e(0,!0)):"object"==typeof i.start&&(e(n(i.start).position().top,null,!0),i.alwaysVisible||u.hide())}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery)